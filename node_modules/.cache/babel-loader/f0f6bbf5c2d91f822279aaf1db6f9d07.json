{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/home/ravi/coinflip/coin-flip-test-main/node_modules/@babel/runtime/regenerator\");\n\nvar _toConsumableArray = require(\"/home/ravi/coinflip/coin-flip-test-main/node_modules/@babel/runtime/helpers/toConsumableArray\");\n\nvar _asyncToGenerator = require(\"/home/ravi/coinflip/coin-flip-test-main/node_modules/@babel/runtime/helpers/asyncToGenerator\");\n\nvar _classCallCheck = require(\"/home/ravi/coinflip/coin-flip-test-main/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/home/ravi/coinflip/coin-flip-test-main/node_modules/@babel/runtime/helpers/createClass\");\n\nvar __classPrivateFieldSet = this && this.__classPrivateFieldSet || function (receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value), value;\n};\n\nvar __classPrivateFieldGet = this && this.__classPrivateFieldGet || function (receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\n\nvar _OwnerManager_ethAdapter, _OwnerManager_safeContract;\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar utils_1 = require(\"../utils\");\n\nvar constants_1 = require(\"../utils/constants\");\n\nvar OwnerManager = /*#__PURE__*/function () {\n  function OwnerManager(ethAdapter, safeContract) {\n    _classCallCheck(this, OwnerManager);\n\n    _OwnerManager_ethAdapter.set(this, void 0);\n\n    _OwnerManager_safeContract.set(this, void 0);\n\n    __classPrivateFieldSet(this, _OwnerManager_ethAdapter, ethAdapter, \"f\");\n\n    __classPrivateFieldSet(this, _OwnerManager_safeContract, safeContract, \"f\");\n  }\n\n  _createClass(OwnerManager, [{\n    key: \"validateOwnerAddress\",\n    value: function validateOwnerAddress(ownerAddress, errorMessage) {\n      var isValidAddress = __classPrivateFieldGet(this, _OwnerManager_ethAdapter, \"f\").isAddress(ownerAddress);\n\n      if (!isValidAddress || (0, utils_1.isRestrictedAddress)(ownerAddress)) {\n        throw new Error(errorMessage || 'Invalid owner address provided');\n      }\n    }\n  }, {\n    key: \"validateThreshold\",\n    value: function validateThreshold(threshold, numOwners) {\n      if (threshold <= 0) {\n        throw new Error('Threshold needs to be greater than 0');\n      }\n\n      if (threshold > numOwners) {\n        throw new Error('Threshold cannot exceed owner count');\n      }\n    }\n  }, {\n    key: \"validateAddressIsNotOwner\",\n    value: function validateAddressIsNotOwner(ownerAddress, owners, errorMessage) {\n      var ownerIndex = owners.findIndex(function (owner) {\n        return (0, utils_1.sameString)(owner, ownerAddress);\n      });\n      var isOwner = ownerIndex >= 0;\n\n      if (isOwner) {\n        throw new Error(errorMessage || 'Address provided is already an owner');\n      }\n    }\n  }, {\n    key: \"validateAddressIsOwner\",\n    value: function validateAddressIsOwner(ownerAddress, owners, errorMessage) {\n      var ownerIndex = owners.findIndex(function (owner) {\n        return (0, utils_1.sameString)(owner, ownerAddress);\n      });\n      var isOwner = ownerIndex >= 0;\n\n      if (!isOwner) {\n        throw new Error(errorMessage || 'Address provided is not an owner');\n      }\n\n      return ownerIndex;\n    }\n  }, {\n    key: \"getOwners\",\n    value: function () {\n      var _getOwners = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var owners;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return __classPrivateFieldGet(this, _OwnerManager_safeContract, \"f\").getOwners();\n\n              case 2:\n                owners = _context.sent;\n                return _context.abrupt(\"return\", _toConsumableArray(owners));\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getOwners() {\n        return _getOwners.apply(this, arguments);\n      }\n\n      return getOwners;\n    }()\n  }, {\n    key: \"getThreshold\",\n    value: function () {\n      var _getThreshold = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                return _context2.abrupt(\"return\", __classPrivateFieldGet(this, _OwnerManager_safeContract, \"f\").getThreshold());\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function getThreshold() {\n        return _getThreshold.apply(this, arguments);\n      }\n\n      return getThreshold;\n    }()\n  }, {\n    key: \"isOwner\",\n    value: function () {\n      var _isOwner = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(ownerAddress) {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                return _context3.abrupt(\"return\", __classPrivateFieldGet(this, _OwnerManager_safeContract, \"f\").isOwner(ownerAddress));\n\n              case 1:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function isOwner(_x) {\n        return _isOwner.apply(this, arguments);\n      }\n\n      return isOwner;\n    }()\n  }, {\n    key: \"encodeAddOwnerWithThresholdData\",\n    value: function () {\n      var _encodeAddOwnerWithThresholdData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(ownerAddress, threshold) {\n        var owners, newThreshold;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                this.validateOwnerAddress(ownerAddress);\n                _context4.next = 3;\n                return this.getOwners();\n\n              case 3:\n                owners = _context4.sent;\n                this.validateAddressIsNotOwner(ownerAddress, owners);\n\n                if (!(threshold !== null && threshold !== void 0)) {\n                  _context4.next = 9;\n                  break;\n                }\n\n                _context4.t0 = threshold;\n                _context4.next = 12;\n                break;\n\n              case 9:\n                _context4.next = 11;\n                return this.getThreshold();\n\n              case 11:\n                _context4.t0 = _context4.sent;\n\n              case 12:\n                newThreshold = _context4.t0;\n                this.validateThreshold(newThreshold, owners.length + 1);\n                return _context4.abrupt(\"return\", __classPrivateFieldGet(this, _OwnerManager_safeContract, \"f\").encode('addOwnerWithThreshold', [ownerAddress, newThreshold]));\n\n              case 15:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function encodeAddOwnerWithThresholdData(_x2, _x3) {\n        return _encodeAddOwnerWithThresholdData.apply(this, arguments);\n      }\n\n      return encodeAddOwnerWithThresholdData;\n    }()\n  }, {\n    key: \"encodeRemoveOwnerData\",\n    value: function () {\n      var _encodeRemoveOwnerData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(ownerAddress, threshold) {\n        var owners, ownerIndex, newThreshold, prevOwnerAddress;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                this.validateOwnerAddress(ownerAddress);\n                _context5.next = 3;\n                return this.getOwners();\n\n              case 3:\n                owners = _context5.sent;\n                ownerIndex = this.validateAddressIsOwner(ownerAddress, owners);\n\n                if (!(threshold !== null && threshold !== void 0)) {\n                  _context5.next = 9;\n                  break;\n                }\n\n                _context5.t0 = threshold;\n                _context5.next = 13;\n                break;\n\n              case 9:\n                _context5.next = 11;\n                return this.getThreshold();\n\n              case 11:\n                _context5.t1 = _context5.sent;\n                _context5.t0 = _context5.t1 - 1;\n\n              case 13:\n                newThreshold = _context5.t0;\n                this.validateThreshold(newThreshold, owners.length - 1);\n                prevOwnerAddress = ownerIndex === 0 ? constants_1.SENTINEL_ADDRESS : owners[ownerIndex - 1];\n                return _context5.abrupt(\"return\", __classPrivateFieldGet(this, _OwnerManager_safeContract, \"f\").encode('removeOwner', [prevOwnerAddress, ownerAddress, newThreshold]));\n\n              case 17:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function encodeRemoveOwnerData(_x4, _x5) {\n        return _encodeRemoveOwnerData.apply(this, arguments);\n      }\n\n      return encodeRemoveOwnerData;\n    }()\n  }, {\n    key: \"encodeSwapOwnerData\",\n    value: function () {\n      var _encodeSwapOwnerData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(oldOwnerAddress, newOwnerAddress) {\n        var owners, oldOwnerIndex, prevOwnerAddress;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                this.validateOwnerAddress(newOwnerAddress, 'Invalid new owner address provided');\n                this.validateOwnerAddress(oldOwnerAddress, 'Invalid old owner address provided');\n                _context6.next = 4;\n                return this.getOwners();\n\n              case 4:\n                owners = _context6.sent;\n                this.validateAddressIsNotOwner(newOwnerAddress, owners, 'New address provided is already an owner');\n                oldOwnerIndex = this.validateAddressIsOwner(oldOwnerAddress, owners, 'Old address provided is not an owner');\n                prevOwnerAddress = oldOwnerIndex === 0 ? constants_1.SENTINEL_ADDRESS : owners[oldOwnerIndex - 1];\n                return _context6.abrupt(\"return\", __classPrivateFieldGet(this, _OwnerManager_safeContract, \"f\").encode('swapOwner', [prevOwnerAddress, oldOwnerAddress, newOwnerAddress]));\n\n              case 9:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function encodeSwapOwnerData(_x6, _x7) {\n        return _encodeSwapOwnerData.apply(this, arguments);\n      }\n\n      return encodeSwapOwnerData;\n    }()\n  }, {\n    key: \"encodeChangeThresholdData\",\n    value: function () {\n      var _encodeChangeThresholdData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(threshold) {\n        var owners;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _context7.next = 2;\n                return this.getOwners();\n\n              case 2:\n                owners = _context7.sent;\n                this.validateThreshold(threshold, owners.length);\n                return _context7.abrupt(\"return\", __classPrivateFieldGet(this, _OwnerManager_safeContract, \"f\").encode('changeThreshold', [threshold]));\n\n              case 5:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function encodeChangeThresholdData(_x8) {\n        return _encodeChangeThresholdData.apply(this, arguments);\n      }\n\n      return encodeChangeThresholdData;\n    }()\n  }]);\n\n  return OwnerManager;\n}();\n\n_OwnerManager_ethAdapter = new WeakMap(), _OwnerManager_safeContract = new WeakMap();\nexports.default = OwnerManager;","map":{"version":3,"sources":["../../../src/managers/ownerManager.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,IAAA,OAAA,GAAA,OAAA,CAAA,UAAA,CAAA;;AACA,IAAA,WAAA,GAAA,OAAA,CAAA,oBAAA,CAAA;;IAEM,Y;AAIJ,wBAAY,UAAZ,EAAoC,YAApC,EAAoE;AAAA;;AAHpE,IAAA,wBAAA,CAAA,GAAA,CAAA,IAAA,EAAA,KAAA,CAAA;;AACA,IAAA,0BAAA,CAAA,GAAA,CAAA,IAAA,EAAA,KAAA,CAAA;;AAGE,IAAA,sBAAA,CAAA,IAAA,EAAI,wBAAJ,EAAmB,UAAnB,EAA6B,GAA7B,CAAA;;AACA,IAAA,sBAAA,CAAA,IAAA,EAAI,0BAAJ,EAAqB,YAArB,EAAiC,GAAjC,CAAA;AACD;;;;WAEO,8BAAqB,YAArB,EAA2C,YAA3C,EAAgE;AACtE,UAAM,cAAc,GAAG,sBAAA,CAAA,IAAA,EAAI,wBAAJ,EAAI,GAAJ,CAAA,CAAiB,SAAjB,CAA2B,YAA3B,CAAvB;;AACA,UAAI,CAAC,cAAD,IAAmB,CAAA,GAAA,OAAA,CAAA,mBAAA,EAAoB,YAApB,CAAvB,EAA0D;AACxD,cAAM,IAAI,KAAJ,CAAU,YAAY,IAAI,gCAA1B,CAAN;AACD;AACF;;;WAEO,2BAAkB,SAAlB,EAAqC,SAArC,EAAsD;AAC5D,UAAI,SAAS,IAAI,CAAjB,EAAoB;AAClB,cAAM,IAAI,KAAJ,CAAU,sCAAV,CAAN;AACD;;AACD,UAAI,SAAS,GAAG,SAAhB,EAA2B;AACzB,cAAM,IAAI,KAAJ,CAAU,qCAAV,CAAN;AACD;AACF;;;WAEO,mCACN,YADM,EAEN,MAFM,EAGN,YAHM,EAGe;AAErB,UAAM,UAAU,GAAG,MAAM,CAAC,SAAP,CAAiB,UAAC,KAAD;AAAA,eAAmB,CAAA,GAAA,OAAA,CAAA,UAAA,EAAW,KAAX,EAAkB,YAAlB,CAAnB;AAAA,OAAjB,CAAnB;AACA,UAAM,OAAO,GAAG,UAAU,IAAI,CAA9B;;AACA,UAAI,OAAJ,EAAa;AACX,cAAM,IAAI,KAAJ,CAAU,YAAY,IAAI,sCAA1B,CAAN;AACD;AACF;;;WAEO,gCACN,YADM,EAEN,MAFM,EAGN,YAHM,EAGe;AAErB,UAAM,UAAU,GAAG,MAAM,CAAC,SAAP,CAAiB,UAAC,KAAD;AAAA,eAAmB,CAAA,GAAA,OAAA,CAAA,UAAA,EAAW,KAAX,EAAkB,YAAlB,CAAnB;AAAA,OAAjB,CAAnB;AACA,UAAM,OAAO,GAAG,UAAU,IAAI,CAA9B;;AACA,UAAI,CAAC,OAAL,EAAc;AACZ,cAAM,IAAI,KAAJ,CAAU,YAAY,IAAI,kCAA1B,CAAN;AACD;;AACD,aAAO,UAAP;AACD;;;;gFAED;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACuB,sBAAA,CAAA,IAAA,EAAI,0BAAJ,EAAI,GAAJ,CAAA,CAAmB,SAAnB,EADvB;;AAAA;AACQ,gBAAA,MADR;AAAA,oEAEa,MAFb;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;;mFAKA;AAAA;AAAA;AAAA;AAAA;AAAA,kDACS,sBAAA,CAAA,IAAA,EAAI,0BAAJ,EAAI,GAAJ,CAAA,CAAmB,YAAnB,EADT;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;;8EAIA,kBAAc,YAAd;AAAA;AAAA;AAAA;AAAA;AAAA,kDACS,sBAAA,CAAA,IAAA,EAAI,0BAAJ,EAAI,GAAJ,CAAA,CAAmB,OAAnB,CAA2B,YAA3B,CADT;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;;sGAIA,kBAAsC,YAAtC,EAA4D,SAA5D;AAAA;AAAA;AAAA;AAAA;AAAA;AACE,qBAAK,oBAAL,CAA0B,YAA1B;AADF;AAAA,uBAEuB,KAAK,SAAL,EAFvB;;AAAA;AAEQ,gBAAA,MAFR;AAGE,qBAAK,yBAAL,CAA+B,YAA/B,EAA6C,MAA7C;;AAHF,sBAIuB,SAAS,KAAA,IAAT,IAAA,SAAS,KAAA,KAAA,CAJhC;AAAA;AAAA;AAAA;;AAAA,+BAIuB,SAJvB;AAAA;AAAA;;AAAA;AAAA;AAAA,uBAI2C,KAAK,YAAL,EAJ3C;;AAAA;AAAA;;AAAA;AAIQ,gBAAA,YAJR;AAKE,qBAAK,iBAAL,CAAuB,YAAvB,EAAqC,MAAM,CAAC,MAAP,GAAgB,CAArD;AALF,kDAMS,sBAAA,CAAA,IAAA,EAAI,0BAAJ,EAAI,GAAJ,CAAA,CAAmB,MAAnB,CAA0B,uBAA1B,EAAmD,CAAC,YAAD,EAAe,YAAf,CAAnD,CANT;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;;4FASA,kBAA4B,YAA5B,EAAkD,SAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AACE,qBAAK,oBAAL,CAA0B,YAA1B;AADF;AAAA,uBAEuB,KAAK,SAAL,EAFvB;;AAAA;AAEQ,gBAAA,MAFR;AAGQ,gBAAA,UAHR,GAGqB,KAAK,sBAAL,CAA4B,YAA5B,EAA0C,MAA1C,CAHrB;;AAAA,sBAIuB,SAAS,KAAA,IAAT,IAAA,SAAS,KAAA,KAAA,CAJhC;AAAA;AAAA;AAAA;;AAAA,+BAIuB,SAJvB;AAAA;AAAA;;AAAA;AAAA;AAAA,uBAI2C,KAAK,YAAL,EAJ3C;;AAAA;AAAA;AAAA,8CAIkE,CAJlE;;AAAA;AAIQ,gBAAA,YAJR;AAKE,qBAAK,iBAAL,CAAuB,YAAvB,EAAqC,MAAM,CAAC,MAAP,GAAgB,CAArD;AACM,gBAAA,gBANR,GAM2B,UAAU,KAAK,CAAf,GAAmB,WAAA,CAAA,gBAAnB,GAAsC,MAAM,CAAC,UAAU,GAAG,CAAd,CANvE;AAAA,kDAOS,sBAAA,CAAA,IAAA,EAAI,0BAAJ,EAAI,GAAJ,CAAA,CAAmB,MAAnB,CAA0B,aAA1B,EAAyC,CAAC,gBAAD,EAAmB,YAAnB,EAAiC,YAAjC,CAAzC,CAPT;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;;0FAUA,kBAA0B,eAA1B,EAAmD,eAAnD;AAAA;AAAA;AAAA;AAAA;AAAA;AACE,qBAAK,oBAAL,CAA0B,eAA1B,EAA2C,oCAA3C;AACA,qBAAK,oBAAL,CAA0B,eAA1B,EAA2C,oCAA3C;AAFF;AAAA,uBAGuB,KAAK,SAAL,EAHvB;;AAAA;AAGQ,gBAAA,MAHR;AAIE,qBAAK,yBAAL,CACE,eADF,EAEE,MAFF,EAGE,0CAHF;AAKM,gBAAA,aATR,GASwB,KAAK,sBAAL,CACpB,eADoB,EAEpB,MAFoB,EAGpB,sCAHoB,CATxB;AAcQ,gBAAA,gBAdR,GAc2B,aAAa,KAAK,CAAlB,GAAsB,WAAA,CAAA,gBAAtB,GAAyC,MAAM,CAAC,aAAa,GAAG,CAAjB,CAd1E;AAAA,kDAeS,sBAAA,CAAA,IAAA,EAAI,0BAAJ,EAAI,GAAJ,CAAA,CAAmB,MAAnB,CAA0B,WAA1B,EAAuC,CAC5C,gBAD4C,EAE5C,eAF4C,EAG5C,eAH4C,CAAvC,CAfT;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;;gGAsBA,kBAAgC,SAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACuB,KAAK,SAAL,EADvB;;AAAA;AACQ,gBAAA,MADR;AAEE,qBAAK,iBAAL,CAAuB,SAAvB,EAAkC,MAAM,CAAC,MAAzC;AAFF,kDAGS,sBAAA,CAAA,IAAA,EAAI,0BAAJ,EAAI,GAAJ,CAAA,CAAmB,MAAnB,CAA0B,iBAA1B,EAA6C,CAAC,SAAD,CAA7C,CAHT;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;;;;;AAOF,OAAA,CAAA,OAAA,GAAe,YAAf","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _OwnerManager_ethAdapter, _OwnerManager_safeContract;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst utils_1 = require(\"../utils\");\nconst constants_1 = require(\"../utils/constants\");\nclass OwnerManager {\n    constructor(ethAdapter, safeContract) {\n        _OwnerManager_ethAdapter.set(this, void 0);\n        _OwnerManager_safeContract.set(this, void 0);\n        __classPrivateFieldSet(this, _OwnerManager_ethAdapter, ethAdapter, \"f\");\n        __classPrivateFieldSet(this, _OwnerManager_safeContract, safeContract, \"f\");\n    }\n    validateOwnerAddress(ownerAddress, errorMessage) {\n        const isValidAddress = __classPrivateFieldGet(this, _OwnerManager_ethAdapter, \"f\").isAddress(ownerAddress);\n        if (!isValidAddress || (0, utils_1.isRestrictedAddress)(ownerAddress)) {\n            throw new Error(errorMessage || 'Invalid owner address provided');\n        }\n    }\n    validateThreshold(threshold, numOwners) {\n        if (threshold <= 0) {\n            throw new Error('Threshold needs to be greater than 0');\n        }\n        if (threshold > numOwners) {\n            throw new Error('Threshold cannot exceed owner count');\n        }\n    }\n    validateAddressIsNotOwner(ownerAddress, owners, errorMessage) {\n        const ownerIndex = owners.findIndex((owner) => (0, utils_1.sameString)(owner, ownerAddress));\n        const isOwner = ownerIndex >= 0;\n        if (isOwner) {\n            throw new Error(errorMessage || 'Address provided is already an owner');\n        }\n    }\n    validateAddressIsOwner(ownerAddress, owners, errorMessage) {\n        const ownerIndex = owners.findIndex((owner) => (0, utils_1.sameString)(owner, ownerAddress));\n        const isOwner = ownerIndex >= 0;\n        if (!isOwner) {\n            throw new Error(errorMessage || 'Address provided is not an owner');\n        }\n        return ownerIndex;\n    }\n    async getOwners() {\n        const owners = await __classPrivateFieldGet(this, _OwnerManager_safeContract, \"f\").getOwners();\n        return [...owners];\n    }\n    async getThreshold() {\n        return __classPrivateFieldGet(this, _OwnerManager_safeContract, \"f\").getThreshold();\n    }\n    async isOwner(ownerAddress) {\n        return __classPrivateFieldGet(this, _OwnerManager_safeContract, \"f\").isOwner(ownerAddress);\n    }\n    async encodeAddOwnerWithThresholdData(ownerAddress, threshold) {\n        this.validateOwnerAddress(ownerAddress);\n        const owners = await this.getOwners();\n        this.validateAddressIsNotOwner(ownerAddress, owners);\n        const newThreshold = threshold !== null && threshold !== void 0 ? threshold : (await this.getThreshold());\n        this.validateThreshold(newThreshold, owners.length + 1);\n        return __classPrivateFieldGet(this, _OwnerManager_safeContract, \"f\").encode('addOwnerWithThreshold', [ownerAddress, newThreshold]);\n    }\n    async encodeRemoveOwnerData(ownerAddress, threshold) {\n        this.validateOwnerAddress(ownerAddress);\n        const owners = await this.getOwners();\n        const ownerIndex = this.validateAddressIsOwner(ownerAddress, owners);\n        const newThreshold = threshold !== null && threshold !== void 0 ? threshold : (await this.getThreshold()) - 1;\n        this.validateThreshold(newThreshold, owners.length - 1);\n        const prevOwnerAddress = ownerIndex === 0 ? constants_1.SENTINEL_ADDRESS : owners[ownerIndex - 1];\n        return __classPrivateFieldGet(this, _OwnerManager_safeContract, \"f\").encode('removeOwner', [prevOwnerAddress, ownerAddress, newThreshold]);\n    }\n    async encodeSwapOwnerData(oldOwnerAddress, newOwnerAddress) {\n        this.validateOwnerAddress(newOwnerAddress, 'Invalid new owner address provided');\n        this.validateOwnerAddress(oldOwnerAddress, 'Invalid old owner address provided');\n        const owners = await this.getOwners();\n        this.validateAddressIsNotOwner(newOwnerAddress, owners, 'New address provided is already an owner');\n        const oldOwnerIndex = this.validateAddressIsOwner(oldOwnerAddress, owners, 'Old address provided is not an owner');\n        const prevOwnerAddress = oldOwnerIndex === 0 ? constants_1.SENTINEL_ADDRESS : owners[oldOwnerIndex - 1];\n        return __classPrivateFieldGet(this, _OwnerManager_safeContract, \"f\").encode('swapOwner', [\n            prevOwnerAddress,\n            oldOwnerAddress,\n            newOwnerAddress\n        ]);\n    }\n    async encodeChangeThresholdData(threshold) {\n        const owners = await this.getOwners();\n        this.validateThreshold(threshold, owners.length);\n        return __classPrivateFieldGet(this, _OwnerManager_safeContract, \"f\").encode('changeThreshold', [threshold]);\n    }\n}\n_OwnerManager_ethAdapter = new WeakMap(), _OwnerManager_safeContract = new WeakMap();\nexports.default = OwnerManager;\n//# sourceMappingURL=ownerManager.js.map"]},"metadata":{},"sourceType":"script"}