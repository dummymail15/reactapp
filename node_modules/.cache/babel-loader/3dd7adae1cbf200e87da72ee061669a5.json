{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/home/ravi/coinflip/coin-flip-test-main/node_modules/@babel/runtime/regenerator\");\n\nvar _asyncToGenerator = require(\"/home/ravi/coinflip/coin-flip-test-main/node_modules/@babel/runtime/helpers/asyncToGenerator\");\n\nvar _classCallCheck = require(\"/home/ravi/coinflip/coin-flip-test-main/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/home/ravi/coinflip/coin-flip-test-main/node_modules/@babel/runtime/helpers/createClass\");\n\nvar __classPrivateFieldSet = this && this.__classPrivateFieldSet || function (receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value), value;\n};\n\nvar __classPrivateFieldGet = this && this.__classPrivateFieldGet || function (receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\n\nvar _ModuleManager_ethAdapter, _ModuleManager_safeContract;\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar utils_1 = require(\"../utils\");\n\nvar constants_1 = require(\"../utils/constants\");\n\nvar ModuleManager = /*#__PURE__*/function () {\n  function ModuleManager(ethAdapter, safeContract) {\n    _classCallCheck(this, ModuleManager);\n\n    _ModuleManager_ethAdapter.set(this, void 0);\n\n    _ModuleManager_safeContract.set(this, void 0);\n\n    __classPrivateFieldSet(this, _ModuleManager_ethAdapter, ethAdapter, \"f\");\n\n    __classPrivateFieldSet(this, _ModuleManager_safeContract, safeContract, \"f\");\n  }\n\n  _createClass(ModuleManager, [{\n    key: \"validateModuleAddress\",\n    value: function validateModuleAddress(moduleAddress) {\n      var isValidAddress = __classPrivateFieldGet(this, _ModuleManager_ethAdapter, \"f\").isAddress(moduleAddress);\n\n      if (!isValidAddress || (0, utils_1.isRestrictedAddress)(moduleAddress)) {\n        throw new Error('Invalid module address provided');\n      }\n    }\n  }, {\n    key: \"validateModuleIsNotEnabled\",\n    value: function validateModuleIsNotEnabled(moduleAddress, modules) {\n      var moduleIndex = modules.findIndex(function (module) {\n        return (0, utils_1.sameString)(module, moduleAddress);\n      });\n      var isEnabled = moduleIndex >= 0;\n\n      if (isEnabled) {\n        throw new Error('Module provided is already enabled');\n      }\n    }\n  }, {\n    key: \"validateModuleIsEnabled\",\n    value: function validateModuleIsEnabled(moduleAddress, modules) {\n      var moduleIndex = modules.findIndex(function (module) {\n        return (0, utils_1.sameString)(module, moduleAddress);\n      });\n      var isEnabled = moduleIndex >= 0;\n\n      if (!isEnabled) {\n        throw new Error('Module provided is not enabled yet');\n      }\n\n      return moduleIndex;\n    }\n  }, {\n    key: \"getModules\",\n    value: function () {\n      var _getModules = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                return _context.abrupt(\"return\", __classPrivateFieldGet(this, _ModuleManager_safeContract, \"f\").getModules());\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getModules() {\n        return _getModules.apply(this, arguments);\n      }\n\n      return getModules;\n    }()\n  }, {\n    key: \"isModuleEnabled\",\n    value: function () {\n      var _isModuleEnabled = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(moduleAddress) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                return _context2.abrupt(\"return\", __classPrivateFieldGet(this, _ModuleManager_safeContract, \"f\").isModuleEnabled(moduleAddress));\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function isModuleEnabled(_x) {\n        return _isModuleEnabled.apply(this, arguments);\n      }\n\n      return isModuleEnabled;\n    }()\n  }, {\n    key: \"encodeEnableModuleData\",\n    value: function () {\n      var _encodeEnableModuleData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(moduleAddress) {\n        var modules;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                this.validateModuleAddress(moduleAddress);\n                _context3.next = 3;\n                return this.getModules();\n\n              case 3:\n                modules = _context3.sent;\n                this.validateModuleIsNotEnabled(moduleAddress, modules);\n                return _context3.abrupt(\"return\", __classPrivateFieldGet(this, _ModuleManager_safeContract, \"f\").encode('enableModule', [moduleAddress]));\n\n              case 6:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function encodeEnableModuleData(_x2) {\n        return _encodeEnableModuleData.apply(this, arguments);\n      }\n\n      return encodeEnableModuleData;\n    }()\n  }, {\n    key: \"encodeDisableModuleData\",\n    value: function () {\n      var _encodeDisableModuleData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(moduleAddress) {\n        var modules, moduleIndex, prevModuleAddress;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                this.validateModuleAddress(moduleAddress);\n                _context4.next = 3;\n                return this.getModules();\n\n              case 3:\n                modules = _context4.sent;\n                moduleIndex = this.validateModuleIsEnabled(moduleAddress, modules);\n                prevModuleAddress = moduleIndex === 0 ? constants_1.SENTINEL_ADDRESS : modules[moduleIndex - 1];\n                return _context4.abrupt(\"return\", __classPrivateFieldGet(this, _ModuleManager_safeContract, \"f\").encode('disableModule', [prevModuleAddress, moduleAddress]));\n\n              case 7:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function encodeDisableModuleData(_x3) {\n        return _encodeDisableModuleData.apply(this, arguments);\n      }\n\n      return encodeDisableModuleData;\n    }()\n  }]);\n\n  return ModuleManager;\n}();\n\n_ModuleManager_ethAdapter = new WeakMap(), _ModuleManager_safeContract = new WeakMap();\nexports.default = ModuleManager;","map":{"version":3,"sources":["../../../src/managers/moduleManager.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _ModuleManager_ethAdapter, _ModuleManager_safeContract;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst utils_1 = require(\"../utils\");\nconst constants_1 = require(\"../utils/constants\");\nclass ModuleManager {\n    constructor(ethAdapter, safeContract) {\n        _ModuleManager_ethAdapter.set(this, void 0);\n        _ModuleManager_safeContract.set(this, void 0);\n        __classPrivateFieldSet(this, _ModuleManager_ethAdapter, ethAdapter, \"f\");\n        __classPrivateFieldSet(this, _ModuleManager_safeContract, safeContract, \"f\");\n    }\n    validateModuleAddress(moduleAddress) {\n        const isValidAddress = __classPrivateFieldGet(this, _ModuleManager_ethAdapter, \"f\").isAddress(moduleAddress);\n        if (!isValidAddress || (0, utils_1.isRestrictedAddress)(moduleAddress)) {\n            throw new Error('Invalid module address provided');\n        }\n    }\n    validateModuleIsNotEnabled(moduleAddress, modules) {\n        const moduleIndex = modules.findIndex((module) => (0, utils_1.sameString)(module, moduleAddress));\n        const isEnabled = moduleIndex >= 0;\n        if (isEnabled) {\n            throw new Error('Module provided is already enabled');\n        }\n    }\n    validateModuleIsEnabled(moduleAddress, modules) {\n        const moduleIndex = modules.findIndex((module) => (0, utils_1.sameString)(module, moduleAddress));\n        const isEnabled = moduleIndex >= 0;\n        if (!isEnabled) {\n            throw new Error('Module provided is not enabled yet');\n        }\n        return moduleIndex;\n    }\n    async getModules() {\n        return __classPrivateFieldGet(this, _ModuleManager_safeContract, \"f\").getModules();\n    }\n    async isModuleEnabled(moduleAddress) {\n        return __classPrivateFieldGet(this, _ModuleManager_safeContract, \"f\").isModuleEnabled(moduleAddress);\n    }\n    async encodeEnableModuleData(moduleAddress) {\n        this.validateModuleAddress(moduleAddress);\n        const modules = await this.getModules();\n        this.validateModuleIsNotEnabled(moduleAddress, modules);\n        return __classPrivateFieldGet(this, _ModuleManager_safeContract, \"f\").encode('enableModule', [moduleAddress]);\n    }\n    async encodeDisableModuleData(moduleAddress) {\n        this.validateModuleAddress(moduleAddress);\n        const modules = await this.getModules();\n        const moduleIndex = this.validateModuleIsEnabled(moduleAddress, modules);\n        const prevModuleAddress = moduleIndex === 0 ? constants_1.SENTINEL_ADDRESS : modules[moduleIndex - 1];\n        return __classPrivateFieldGet(this, _ModuleManager_safeContract, \"f\").encode('disableModule', [prevModuleAddress, moduleAddress]);\n    }\n}\n_ModuleManager_ethAdapter = new WeakMap(), _ModuleManager_safeContract = new WeakMap();\nexports.default = ModuleManager;\n//# sourceMappingURL=moduleManager.js.map"]},"metadata":{},"sourceType":"script"}